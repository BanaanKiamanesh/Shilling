function [Time, Y] = odeRKO10(f, TSpan, Y0, h)
    %ODERKO10 10th Order Runge-Kutta Ono's Method Implementation
    % Inputs:
    %   f: function handle for the ODE
    %   TSpan: time span as [t0, tf]
    %   Y0: initial condition as a column vector (default: zeros)
    %   h: initial step size (default: 0.01)
    %
    % Example Usage:
    %   f = @(t, x) [x(2); (1 - x(1)^2)*x(2) - x(1)]; % Van der Pol ODE
    %   TSpan= [0, 20];    % Time span
    %   Y0= [2; 0];        % Initial condition
    %   h = 0.01;          % Initial step size
    %   [T, Y] = odeRKO10(f, TSpan, Y0, h);
    %
    %   % Plot results
    %   figure;
    %   plot(T, Y, 'LineWidth', 2);
    %   xlabel('Time [s]');
    %   ylabel('State Variables');
    %   title('Van der Pol Equation Solution');
    %   grid on;
    %   axis([0, 20, -3, 3]);
    %
    % Reference
    %   * Hiroshi Ono, "A Runge-Kutta method of order 10 which minimizes truncation error",
    %       The Japan Society for Industrial and Applied Mathematics,
    %       Vol. 13, No. 1, 2003, pp 35 - 44.

    % Set default values if not provided
    if nargin < 4
        h = 0.01;
    end

    t0 = TSpan(1);
    tf = TSpan(2);

    % Initial setup
    t = t0;
    y = Y0;

    % Method Params
    digits(85);
    a2  = vpa(0.3357505083417036184129939488963472892525539577157696170900805997207182929518116563365);
    a3  = vpa(0.5263563553500217821118595221339767434067222948292617539626688113669112965383197614021);
    a4  = vpa(0.7895345330250326731677892832009651151100834422438926309440032170503669448074796421031);
    a5  = vpa(0.1852155685265047076970656199437875208987680209449849941608024849050604421517806064228);
    a6  = vpa(0.2895345330250326731677892832009651151100834422438926309440032170503669448074796421031);
    a7  = vpa(0.7659879027055932401898717206953675811356898851157703878511505293452324618973555436361);
    a8  = vpa(0.1080739009578824490100240661758266719014599665988034811870817465871751958605805741080);
    a9  = vpa(0.3573842417596774518429245029795604640404982636367873040901247917361510345429002009092);
    a10 = vpa(0.8825276619647323464255014869796690751828678442680521196637911779185276585194132570617);
    a11 = vpa(0.6426157582403225481570754970204395359595017363632126959098752082638489654570997990908);
    a12 = vpa(0.1174723380352676535744985130203309248171321557319478803362088220814723414805867429383);
    a13 = vpa(0.7659879027055932401898717206953675811356898851157703878511505293452324618973555436361);
    a14 = vpa(0.2895345330250326731677892832009651151100834422438926309440032170503669448074796421031);
    a15 = vpa(0.5263563553500217821118595221339767434067222948292617539626688113669112965383197614021);
    a16 = vpa(0.3357505083417036184129939488963472892525539577157696170900805997207182929518116563365);

    b21   = vpa(0.3357505083417036184129939488963472892525539577157696170900805997207182929518116563365);
    b31   = vpa(0.1137717040478783056449396184425018992536986324028992632761012508174661576282091865815);
    b32   = vpa(0.4125846513021434764669199036914748441530236624263624906865675605494451389101105748206);
    b41   = vpa(0.1973836332562581682919473208002412787775208605609731577360008042625917362018699105258);
    b43   = vpa(0.5921508997687745048758419624007238363325625816829194732080024127877752086056097315774);
    b51   = vpa(0.1360001717992528326665261557210531883399922632350163155393510462488093550801937826726);
    b53   = vpa(0.8247208052028112223790799775745048180379960003630910417779053602715946236310693542837e-1);
    b54   = vpa(0.3325668379302924720736853353471614924502384232634042555633909737090837529152011167815e-1);
    b61   = vpa(0.6546785199481110579756630335868870724165088583024509548938434492848601278421108871818e-1);
    b64   = vpa(0.6858715620423033993966826640550281985093888681236135859756994188871385539662876478859e-3);
    b65   = vpa(0.2233808094681792639708262971782213796699231675455239218686431727029937934693022657371);
    b71   = vpa(0.2379439999135994223360182301765245366877534054337310606780367192080205084533052094979);
    b74   = vpa(0.1285793626493546102687479560301629068933431333159680850577212924587597635005521433930);
    b75   = vpa(0.7303763776380165799305971651206183012312272113455920027358381669467410091843571268521);
    b76   = vpa(10.129840917780655787515702699609298438785820557711663244851230684625193199127855317597);
    b81   = vpa(0.6062780896441720418288517632894493561013839292138719356621888281245740094338544165775e-1);
    b85   = vpa(0.7888222248692022386398029561573557081956734138939980123787302990185683517283562747179e-1);
    b86   = vpa(0.3213213504125939005101626782074483911778772517654658420946839341553511609992151857815e-1);
    b87   = vpa(0.6960045478044110141748620518910045895419574645630705924582272883960758442810235566394e-3);
    b91   = vpa(0.3104415865438721889084097538819995930358479868352200893591644921124828667005686536920e-1);
    b96   = vpa(0.1571656120644442171909172634188670081467914525944196307657031602142991040495820182979);
    b97   = vpa(0.1117638541384084302989687338271505642661663918417037071041752801553969715970722155609e-3);
    b98   = vpa(0.1690627071867076073308672954386663460258558459670039606814010070304482468516642450265);
    b101  = vpa(0.1430614201422677732943411456202705981582929884075538519224332811759391256045628709601e-1);
    b106  = vpa(0.3914725335338579386439799990026912235591541327277623987271673700062264924050571982953);
    b107  = vpa(0.2848400967322984698670378405298733357388045123736554424201702352859211869408079104816);
    b108  = vpa(0.2559426777170804941167590501634194225203620020234561863154326261989141389268124787652);
    b109  = vpa(0.7189112790349845437562504807270404806670261637579475044631123583223249124963937790142);
    b111  = vpa(0.1006668457426631788172270822620227260906121023931371723741841060852730989522549641648e-1);
    b116  = vpa(0.3683271809355001194608455001594963737510628435069995678571139196388186857259494651043);
    b117  = vpa(0.8575502624022299903546939609254513705068159712672738891650679949767497156363396523266e-1);
    b118  = vpa(0.2633792404483482304677774849110341109669789276529274236259927084605103685123897043694);
    b119  = vpa(0.6783120744401823352568978305425238981627472606453781308422134412090277276134222894570);
    b1110 = vpa(0.2657008652719721502394642259236950907890441579413439685514223187307272640162219128045e-1);
    b121  = vpa(0.4212573015701458022875431871453412827491044618882839077863171149554249469159410384126e-1);
    b126  = vpa(0.1140730257394986628323587415013320453327540775054758894945046140858856585220720793160e-1);
    b127  = vpa(0.3577323583881041642639854910390843838477094752248779125994771974507179107770816673622e-2);
    b128  = vpa(0.8478085069047181595883795669333443274198965196004767054783136203447118275436721594692e-1);
    b129  = vpa(0.8236897403845190534516723638464155343698796681468739910260266595384301707513187151823e-4);
    b1210 = vpa(0.7920174936649160445251535005941104644271462692404428580786438040911208546142377592512e-3);
    b1211 = vpa(0.4840734825985701173601980408776943260994401783442431626214940796417131157064341867563e-2);
    b131  = vpa(0.1866168584194642618748985099397434698267694490527249444362505121514680479505442836574);
    b134  = vpa(0.1285793626493546102687479560301629068933431333159680850577212924587597635005521433930);
    b135  = vpa(0.7303763776380165799305971651206183012312272113455920027358381669467410091843571268521);
    b136  = vpa(0.3365620746651354218129539461265307620933082614096471567813938850533189571406833598679);
    b137  = vpa(0.3439152195696137654283681672732838006806635738118480999635325742827372086353048385257);
    b138  = vpa(0.6116809614283795957124860804122425718138169583157463948158033894717678649195939132136);
    b139  = vpa(0.8555642651045021202243366091904917631763787495189342130253621820535903092162656518481);
    b1310 = vpa(0.8913928524866960048456401557668818573165120479499861285407465844438950550960191679472e-1);
    b1311 = vpa(0.4263317531098201582091498458499961586420389075833366648914840378325891404712881232497);
    b1312 = vpa(0.4510834231343501965076085217297850477436729165851712257475164429026900343003414799732);
    b141  = vpa(0.8132722174581177948072809791683141502457873136125978954741528825822682868334020231374e-1);
    b144  = vpa(0.6858715620423033993966826640550281985093888681236135859756994188871385539662876478859e-3);
    b145  = vpa(0.2233808094681792639708262971782213796699231675455239218686431727029937934693022657371);
    b146  = vpa(0.3543152669595614715438074770044728248424634682417120916726014150358797064660842419218);
    b147  = vpa(0.1614228337471357340842753214971350545154909424968569413717974406833347832344548170007);
    b148  = vpa(-10.267989518319081979614362221100086229540210555088918164010191288219362963604567702803);
    b149  = vpa(0.2482505660965057784745955362600844051763121832196360142449926255422280563592831868088);
    b1410 = vpa(0.1894015072204329862304305088267495664543558350848310970103331708369628629196601961145e-2);
    b1411 = vpa(0.2367108504250404697299275875477514623653536202773466252372015412173547424356865161882e-1);
    b1412 = vpa(10.376373544047006195976245547649688122109906103559164922810806152088122419417100442009);
    b1413 = vpa(0.1650212091015662542191305948002865244010106371945579174943772453918520072439660689694);
    b151  = vpa(0.1137717040478783056449396184425018992536986324028992632761012508174661576282091865815);
    b152  = vpa(0.4125846513021434764669199036914748441530236624263624906865675605494451389101105748206);
    b156  = vpa(0.5266141894222268880524004361760397955773267936583064281992495328485812564705031059898);
    b157  = vpa(0.4270299995350464166415042303891280056028480962227556089080302280248036279775533169729);
    b1513 = vpa(0.4270299995350464166415042303891280056028480962227556089080302280248036279775533169729);
    b1514 = vpa(0.5266141894222268880524004361760397955773267936583064281992495328485812564705031059898);
    b161  = vpa(0.3357505083417036184129939488963472892525539577157696170900805997207182929518116563365);
    b163  = vpa(0.4368367083891407610190158064846822677554138099678168504498524386288907219928146135373);
    b1615 = vpa(0.4368367083891407610190158064846822677554138099678168504498524386288907219928146135373);
    b171  = vpa(0.3528400914539065757695374250020526983792042094778706633574048575138598395445375459964e-1);
    b172  = vpa(0.4368588562339554617519938616027395568153523718226810275461527253101515442644071737416);
    b173  = vpa(0.5185253025751911700815354370658368214653404020923461413204927007907407344767758710502);
    b176  = vpa(0.8353882146318347708823979907871444293693024897533008980286851134950209556868285481998e-1);
    b177  = vpa(0.3357324883823615793514438806416832609180686549969009829861766772233990660034579152038);
    b178  = vpa(0.1180346853290197678148440843338719378456952414935754110833043790640005049977678056530);
    b179  = vpa(0.2028121524999718341813208304021045923675061150408674489110338814798518734278169865166);
    b1710 = vpa(0.4018734442526045674154192467995252408036818247069631361197899796078897150680466096292);
    b1711 = vpa(0.6982808681238487516481594542254805552510541794271997632640921307356093400075120505480);
    b1712 = vpa(0.2745953340127460413630142920026546525788337913278252157685398122819348957290706395825);
    b1713 = vpa(0.8071051158813288531951186779278104056732084407804403857002131168492985419909905100904);
    b1714 = vpa(0.2986469883301853807480531774155235135599206769328769914173437804434298240853514778770);
    b1715 = vpa(0.5185253025751911700815354370658368214653404020923461413204927007907407344767758710502);
    b1716 = vpa(0.4368588562339554617519938616027395568153523718226810275461527253101515442644071737416);

    c1  = vpa(0.3333333333333333333333333333333333333333333333333333333333333333333333333333333333333e-1);
    c2  = vpa(0.2192242833052276559865092748735244519392917369308600337268128161888701517706576728499e-1);
    c3  = vpa(0.5671077504725897920604914933837429111531190926275992438563327032136105860113421550095e-1);
    c6  = vpa(0.5604719764011799410029498525073746312684365781710914454277286135693215339233038348083e-1);
    c7  = vpa(0.1789297658862876254180602006688963210702341137123745819397993311036789297658862876254);
    c9  = vpa(0.2774291885177431765083602625606543404285043197180408363394722409866844803871713937960);
    c10 = vpa(0.1892374781489234901583064041060123262381623469486258303271944256799821862794952728707);
    c11 = vpa(0.2774291885177431765083602625606543404285043197180408363394722409866844803871713937960);
    c12 = vpa(0.1892374781489234901583064041060123262381623469486258303271944256799821862794952728707);
    c13 = vpa(0.1789297658862876254180602006688963210702341137123745819397993311036789297658862876254);
    c14 = vpa(0.5604719764011799410029498525073746312684365781710914454277286135693215339233038348083e-1);
    c15 = vpa(0.5671077504725897920604914933837429111531190926275992438563327032136105860113421550095e-1);
    c16 = vpa(0.2192242833052276559865092748735244519392917369308600337268128161888701517706576728499e-1);
    c17 = vpa(0.3333333333333333333333333333333333333333333333333333333333333333333333333333333333333e-1);


    % Preallocate arrays to store values
    StepNum = ceil((tf - t0)  /  h);
    Time    = zeros(StepNum, 1);
    Y       = zeros(StepNum, length(Y0));
    Time(1) = t;
    Y(1, :) = y';

    % Main Loop
    Idx = 1;
    while t < tf
        % Method
        k1  = f(        t,                                                                                                                                                               y);
        k2  = f( t + a2*h,                                                                                                                                                  y + h*(b21*k1));
        k3  = f( t + a3*h,                                                                                                                                         y + h*(b31*k1 + b32*k2));
        k4  = f( t + a4*h,                                                                                                                                         y + h*(b41*k1 + b43*k3));
        k5  = f( t + a5*h,                                                                                                                                y + h*(b51*k1 + b53*k3 + b54*k4));
        k6  = f( t + a6*h,                                                                                                                                y + h*(b61*k1 + b64*k4 + b65*k5));
        k7  = f( t + a7*h,                                                                                                                       y + h*(b71*k1 + b74*k4 + b75*k5 + b76*k6));
        k8  = f( t + a8*h,                                                                                                                       y + h*(b81*k1 + b85*k5 + b86*k6 + b87*k7));
        k9  = f( t + a9*h,                                                                                                                       y + h*(b91*k1 + b96*k6 + b97*k7 + b98*k8));
        k10 = f(t + a10*h,                                                                                                         y + h*(b101*k1 + b106*k6 + b107*k7 + b108*k8 + b109*k9));
        k11 = f(t + a11*h,                                                                                             y + h*(b111*k1 + b116*k6 + b117*k7 + b118*k8 + b119*k9 + b1110*k10));
        k12 = f(t + a12*h,                                                                                 y + h*(b121*k1 + b126*k6 + b127*k7 + b128*k8 + b129*k9 + b1210*k10 + b1211*k11));
        k13 = f(t + a13*h,                                                 y + h*(b131*k1 + b134*k4 + b135*k5 + b136*k6 + b137*k7 + b138*k8 + b139*k9 + b1310*k10 + b1311*k11 + b1312*k12));
        k14 = f(t + a14*h,                                     y + h*(b141*k1 + b144*k4 + b145*k5 + b146*k6 + b147*k7 + b148*k8 + b149*k9 + b1410*k10 + b1411*k11 + b1412*k12 + b1413*k13));
        k15 = f(t + a15*h,                                                                                           y + h*(b151*k1 + b152*k2 + b156*k6 + b157*k7 + b1513*k13 + b1514*k14));
        k16 = f(t + a16*h,                                                                                                                           y + h*(b161*k1 + b163*k3 + b1615*k15));
        k17 = f(    t + h, y + h*(b171*k1 + b172*k2 + b173*k3 + b176*k6 + b177*k7 + b178*k8 + b179*k9 + b1710*k10 + b1711*k11 + b1712*k12 + b1713*k13 + b1714*k14 + b1715*k15 + b1716*k16));

        % Update Values
        y = y  +  h*(c1*k1 + c2*k2 + c3*k3 + c6*k6 + c7*k7 + c9*k9 + c10*k10 + c11*k11 + c12*k12 + c13*k13 + c14*k14 + c15*k15 + c16*k16 + c17*k17);
        t = t  +  h;

        % Store Values
        Idx       = Idx + 1;
        Time(Idx) = t;
        Y(Idx, :) = y';
    end
end
