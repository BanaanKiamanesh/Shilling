function [Time, Y] = odeRKZ10(f, TSpan, Y0, h)
    %ODERKZ10 10th Order Runge-Kutta Zhang Method Implementation
    % Inputs:
    %   f: function handle for the ODE
    %   TSpan: time span as [t0, tf]
    %   Y0: initial condition as a column vector (default: zeros)
    %   h: initial step size (default: 0.01)
    %
    % Example Usage:
    %   f = @(t, x) [x(2); (1 - x(1)^2)*x(2) - x(1)]; % Van der Pol ODE
    %   TSpan= [0, 20];    % Time span
    %   Y0= [2; 0];        % Initial condition
    %   h = 0.01;          % Initial step size
    %   [T, Y] = odeRKZ10(f, TSpan, Y0, h);
    %
    %   % Plot results
    %   figure;
    %   plot(T, Y, 'LineWidth', 2);
    %   xlabel('Time [s]');
    %   ylabel('State Variables');
    %   title('Van der Pol Equation Solution');
    %   grid on;
    %   axis([0, 20, -3, 3]);
    %
    % Reference
    %   * David K. Zhang, "Discovering New Runge-Kutta Methods Using Unstructured Numerical Search",
    %       Thesis, April 16, 2019 [1911.00318.pdf](https://arxiv.org/pdf/1911.00318.pdf)
    %   * [Coefficients](https://github.com/dzhang314/rktk/blob/master/methods/Zhang10.txt)

    % Set default values if not provided
    if nargin < 4
        h = 0.01;
    end

    t0 = TSpan(1);
    tf = TSpan(2);

    % Initial setup
    t = t0;
    y = Y0;

    % Method Params
    b21   = +0.06888096612188652230677098661632935381315159322698285980682460033484176156636;
    b31   = -0.83810520353364237535186366202804838694106968892100493081079119861616316483888;
    b32   = +1.25369004871695465344923436259290210937215845259642921936068038992469719487344;
    b41   = -0.00490948675932680175369634467679043271190185159760893197940412354439119879747;
    b42   = +0.08232173030768021571147603044143500716498050758632346872918243517328221749373;
    b43   = -0.00853127742646689165100869914831522063992706276173167694295371129404925712991;
    b51   = +1.04893195376435953811751460952804681519865641127045728585681123905425821150864;
    b52   = -0.75382817731759581241904280322911590179250916990960557195131331600659134298994;
    b53   = +0.80522815974064911780476652756884437914316713728791543021500322792680878839117;
    b54   = -0.38446322074238561063992159166768203951623890872336238198515458977800812023865;
    b61   = -0.23992383433329995270018501071487605020336614587127799309879281304981537313900;
    b62   = -0.06364261163929229571107164643776483490956349179570579724023318438638668084701;
    b63   = +0.19967543135197895864283978317448663244372194705250026204952108330132418721869;
    b64   = +0.61035379509547002158981202467825146906358429601618359949777530100370262806814;
    b65   = +0.37859947224999048426403753064329493462141566215033797838496558400426835557965;
    b71   = +0.01778833946316172550067667113299992644020408256145083580468064240809624146756;
    b72   = -0.01105021905501825472152093430479940021746699824126398377648788328289961044531;
    b73   = -0.00439342855052892929633342674635339618911779936473248023015437836908839819799;
    b74   = +0.10597527290509018731505658395393495306363828909501538659771103682791206047696;
    b75   = +0.00405089069638330732472929903714130352675532845602736909932582009874330236167;
    b76   = -0.00167929709134223461022001825411827908084682305838572957913124250043819202374;
    b81   = +0.23566046225418537925692690356824973135127585829120749799176100081366132717900;
    b82   = +0.08893362689701559656112930868794335701480724068673657440558996917556014206620;
    b83   = +0.04138834709876858545169518341465722051417932518424807026039922164100253591914;
    b84   = -0.85290303603263069912309614093599359240031750375681439893926580845622126359984;
    b85   = -0.02308087548113625563008379864870135277272977633339373075859414529485111031087;
    b86   = +0.00968592188591852514590807745954989979539211465004178878459403530669594442891;
    b87   = +0.80144977934196893864833794701047679699141990680205169668196460489197395944287;
    b91   = +0.09048693760705330681795027653195090842362561521235737211709949607524998063814;
    b92   = +0.03204427202479226242378001797390171191984804295279358947221505285617826137779;
    b93   = +0.12433768215891056280095053314827014992247446913700152962717366852615035330919;
    b94   = -0.30731521755038158104946232011583084977900951861660916480042444618524837737411;
    b95   = +0.16447843681160268810163161551627427448581444120771873237010859382161886567365;
    b96   = -0.04100681167344768439646557295106150922485658224571650562701715147123044716022;
    b97   = +0.40661989930773198456977153545461924102851176247811339291440854490078881632775;
    b98   = +0.18669987124631939180018777607871869034096434382893787663176153320303681978038;
    b101  = -0.12815849137721058028379122684114729957595452282110310092889040855742427673083;
    b102  = -0.09494292242532245543748881606192770346771760827967185000597507680447193729080;
    b103  = -0.14450344511826259894917045729900439186304081642314445476990786282061867102157;
    b104  = +0.92134940704406912363606156819205798706915260363096464763106069459083167107327;
    b105  = -0.13265301054949046320484467982507968172620145761107284691851092173475314294014;
    b106  = +0.01661485872631464348319012586897860991564771318706900087871886151957318825574;
    b107  = -0.64461773243991825568826538659502156175792556790721387489238296660149971176174;
    b108  = +0.47148463683422024098060807066053294761028203774917809473770514989820710158152;
    b109  = +0.15101154448891262356107150246546481622684638215041867281807172181868980886911;
    b111  = -0.35394262889926481874318272132638227200275604000107564690424492655250744148526;
    b112  = -0.12999250061102426001102206164524015480707041252098090235235458563228391897841;
    b113  = +0.07296717474130959358123820183761890201581557542115580687780801792533382974931;
    b114  = +1.23409288203437673148811178545199717478084359792767549031487434785241641765067;
    b115  = +0.24325479314414790350916184694938182359002523242070889454561579643424180130675;
    b116  = -0.04886415340347670065787549059652108014832442895629947389530738182689787996728;
    b117  = -0.51442371407978914516038594645191171303742863244306956194414424856852330710239;
    b118  = +0.07088500449199304304537010242765865457286791828303557337358385517356109210099;
    b119  = -0.20555333994396552677698205301698855743095009068049025897065388713681681672772;
    b1110 = +0.04716132770900545782293703693524094489806604422476436750471220364001025348790;
    b121  = -1.28883596401187309154174375754588391722337985378291577953064993833085325077145;
    b122  = -0.28020869761589692854933312826845810393637896090137224607343344880154309805585;
    b123  = +2.95502531060581466025398140893693575414694538631086569687435523799636000133369;
    b124  = +2.68729452804277601048934070442766694554427130448420986662047690713132366345266;
    b125  = +4.94062342991935573838476417426809163760371481941041460313006887242753416771859;
    b126  = -1.10669748003212502578007105340045335120159611347391447923604138591653946190627;
    b127  = -1.01499184284449721513261150169983810954496707583685170059698090784083909089787;
    b128  = +2.53750982609373480524394613209930567128221625331336116097749979112883387569908;
    b129  = -3.05085435525303312587778339284072228780737127406865428592625671405448243077510;
    b1210 = -4.48248369012964780236263511347668602256466957962418723733767273268597925464354;
    b1211 = -1.21257843188510861623323738621796488386816954981559478788233918659317859600661;
    b131  = -0.26440344286774078027313975052115341819194404740705505988980388884472351746613;
    b132  = -0.06681118811399606825394685412417487195704333031683770523718698572711060614338;
    b133  = +0.22983178806827308655694675660046084355033982772309698316158066683955449428729;
    b134  = +0.64074149645736181719485655167408177784648088775776468738158085006283347730738;
    b135  = +0.42942911081576828545053652299580217770451868606900245607955202491949872419495;
    b136  = -0.00967078876662303036856558223558993132212111489612543886857914521712390529304;
    b137  = +0.01613666672999681392501812041282804272240296713357286534780333216134004281864;
    b138  = -0.03596314318487727365094853269870982256844289210631058204493077377818835633949;
    b139  = -0.04902670091896965612083428201101205091198148478269054303875029017005640576667;
    b1310 = +0.01388537673498896790224810676002758506392838309962714417674884945696557987538;
    b1311 = -0.02329475109524907760636494276820464664967810607545806961371703044079964798003;
    b1312 = +0.00411071472206196739547606137318514638902786727009559929394539277815884070579;
    b141  = +1.28995927881082034516023610876593719136951515200841564716720963602983766539309;
    b142  = +0.13503265202676397192358271319486347590315093450300003507414087911915346743493;
    b143  = -1.57533735338626298015011591165511659112640458688783385930436332029909777715227;
    b144  = -1.13614144125767380945133294734170682018114470434355261134291967031467884444496;
    b145  = -2.60629976327340284860734294234508518773200013764798796731373995419345584010989;
    b146  = -0.14225514857221282929776869245957057127882456911938845124276329363250774479820;
    b147  = -1.30050279397530175137190231972314623324238865480815606289913301764254981931424;
    b148  = +2.70797163114645615543070920761013389431867941711011998785845670786144007733081;
    b149  = +2.43554296946750176014394493560037156798756615586273835416220476865949138763199;
    b1410 = -0.26458182516446999987007272710827096690076304619434648405874330108389046658365;
    b1411 = +0.28431747275350668428305940521170347967298804085514279367418757904848425107603;
    b1412 = -0.01567336501605444936187349334932741547111318613954509638698908027760861917463;
    b1413 = +0.60355253162364202926624736416406789911182794847681800316234125803391629274555;
    b151  = -0.82170145239485721248182614307298014363501501247665665859542963907661741852252;
    b152  = +1.25591221619821840505806060191670198289896021578755350597122093077684012752648;
    b153  = -0.01615284116525821921698589364201132298146948312403205059324494512949466638820;
    b154  = -0.02297038987201048533939731478067813642773684981394747854111883904855646952919;
    b155  = -0.02796034376707111482574969609615809805957457730932703561247060660045527963337;
    b156  = -0.75094298727080692288567852962945843784728392190426468013732662611274129611030;
    b157  = -0.00831029089278008603544533798969572897337060350821384521268253868513966100453;
    b158  = +0.02785523862077057819395231768788127899618354611871665730619924470585495216854;
    b159  = +0.04021421539333651503730432703988977024358721548426886753518601253708363296062;
    b1510 = +1.61713646360095425893804116572314412328254887955289755326352595104935489454125;
    b1511 = -1.39628377741243214317623603663032161218084680028714877542197062209713837494256;
    b1512 = -0.01424439159061064208304848726946155039179802539115130281665541763757472383980;
    b1513 = +0.75709054336643265169970374917936196757291644158102449813751290304179069353124;
    b1514 = -0.22405735763057330478532402187136037006601226103429496673285661641467238072308;
    b161  = +0.27726401853185531071095250844208662954769209843860654782270439586107555912462;
    b162  = +0.09453818370728229619312145290868518019954577268055790438905422269619151226603;
    b163  = +0.84172754295454286541980788975065897179825972249436132684274103676922879908590;
    b164  = -0.90665259832844475943298457713954683980649043330939335614048943465366310987303;
    b165  = -0.09334858033923263720339222938292231543826754868386677793091178055855225779084;
    b166  = +4.08887758914114010965574538791054120551785765841976165061624483740399180627400;
    b167  = +0.79539986499428990687079492545982314739495812782573436535546220822826278953650;
    b168  = -0.04859175145875636251218702854395529418032114353274620641007859711365783956136;
    b169  = +0.14819851457498430887143064575970769402240035004018486609649448109702272035773;
    b1610 = -1.77021148062189597056755123808303838576982978034562033343027660487016998355672;
    b1611 = +1.83821084492008174732030666893446362369060575712213328902105414298283276556307;
    b1612 = +0.04909344463430916722179909282844531508454281205967923461622573420987424382584;
    b1613 = -3.80378823067007538071243467410680278604792596795503781745130930797860484235966;
    b1614 = +0.33157239872339854149205035234217673029656296754907585248267975563293121409049;
    b1615 = -0.84228976076347914332745917708032287630959039280343054587959508970676337698255;

    c1 = +0.03181927458023409759419419944088926839595967458804889313841865851348230504492;
    c3 = +0.04681369289018421954398607025172424191865836856120072277976273594277845007872;
    c6 = +1.37553536170545749013126339747598151094852489823041688723220548486290269295630;
    c7 = +0.17506567143964248943590740397548086595186840317795589108615338820052040464001;
    c8 = +0.14924798653008455234489054168544610975862154045444166485218499565185924479229;
    c9 = +0.27180992312662372142355988162582830282467844949919584507610421296773792690656;
    c10 = -0.17077940511361075387191294440611902706762757201779959741914461935949309724569;
    c11 = +0.30035519768848521819453255694344499143765502380409939822945376435190034136303;
    c12 = -0.01014254403202798636405231311418830930667910487160410011307114999518762983823;
    c13 = -1.19177815782093190956613115811061881440838744821819017576359936663422556606341;
    c14 = +0.03639139354170713653095246097302347593652682408895579802073390992985525665017;
    c15 = -0.04683316086510645556720041443823709643011325850704077997225219431585033242635;
    c16 = +0.03249476632925818017001031769734448004031420121031955285305017988372000314167;

    a1  = 0;
    a2  = b21;
    a3  = b31  + b32;
    a4  = b41  + b42  + b43;
    a5  = b51  + b52  + b53  + b54;
    a6  = b61  + b62  + b63  + b64  + b65;
    a7  = b71  + b72  + b73  + b74  + b75  + b76;
    a8  = b81  + b82  + b83  + b84  + b85  + b86  + b87;
    a9  = b91  + b92  + b93  + b94  + b95  + b96  + b97  + b98;
    a10 = b101 + b102 + b103 + b104 + b105 + b106 + b107 + b108 + b109;
    a11 = b111 + b112 + b113 + b114 + b115 + b116 + b117 + b118 + b119 + b1110;
    a12 = b121 + b122 + b123 + b124 + b125 + b126 + b127 + b128 + b129 + b1210 + b1211;
    a13 = b131 + b132 + b133 + b134 + b135 + b136 + b137 + b138 + b139 + b1310 + b1311 + b1312;
    a14 = b141 + b142 + b143 + b144 + b145 + b146 + b147 + b148 + b149 + b1410 + b1411 + b1412 + b1413;
    a15 = b151 + b152 + b153 + b154 + b155 + b156 + b157 + b158 + b159 + b1510 + b1511 + b1512 + b1513 + b1514;
    a16 = b161 + b162 + b163 + b164 + b165 + b166 + b167 + b168 + b169 + b1610 + b1611 + b1612 + b1613 + b1614 + b1615;

    % Preallocate arrays to store values
    StepNum = ceil((tf - t0)  /  h);
    Time    = zeros(StepNum, 1);
    Y       = zeros(StepNum, length(Y0));
    Time(1) = t;
    Y(1, :) = y';

    % Main Loop
    Idx = 1;
    while t < tf
        % Method
        k1  = f( t + a1*h,                                                                                                                                                                       y);
        k2  = f( t + a2*h,                                                                                                                                                          y + h*(b21*k1));
        k3  = f( t + a3*h,                                                                                                                                                y + h*(b31*k1  + b32*k2));
        k4  = f( t + a4*h,                                                                                                                                      y + h*(b41*k1  + b42*k2  + b43*k3));
        k5  = f( t + a5*h,                                                                                                                            y + h*(b51*k1  + b52*k2  + b53*k3  + b54*k4));
        k6  = f( t + a6*h,                                                                                                                  y + h*(b61*k1  + b62*k2  + b63*k3  + b64*k4  + b65*k5));
        k7  = f( t + a7*h,                                                                                                        y + h*(b71*k1  + b72*k2  + b73*k3  + b74*k4  + b75*k5  + b76*k6));
        k8  = f( t + a8*h,                                                                                              y + h*(b81*k1  + b82*k2  + b83*k3  + b84*k4  + b85*k5  + b86*k6  + b87*k7));
        k9  = f( t + a9*h,                                                                                    y + h*(b91*k1  + b92*k2  + b93*k3  + b94*k4  + b95*k5  + b96*k6  + b97*k7  + b98*k8));
        k10 = f(t + a10*h,                                                                         y + h*(b101*k1 + b102*k2 + b103*k3 + b104*k4 + b105*k5 + b106*k6 + b107*k7 + b108*k8 + b109*k9));
        k11 = f(t + a11*h,                                                             y + h*(b111*k1 + b112*k2 + b113*k3 + b114*k4 + b115*k5 + b116*k6 + b117*k7 + b118*k8 + b119*k9 + b1110*k10));
        k12 = f(t + a12*h,                                                 y + h*(b121*k1 + b122*k2 + b123*k3 + b124*k4 + b125*k5 + b126*k6 + b127*k7 + b128*k8 + b129*k9 + b1210*k10 + b1211*k11));
        k13 = f(t + a13*h,                                     y + h*(b131*k1 + b132*k2 + b133*k3 + b134*k4 + b135*k5 + b136*k6 + b137*k7 + b138*k8 + b139*k9 + b1310*k10 + b1311*k11 + b1312*k12));
        k14 = f(t + a14*h,                         y + h*(b141*k1 + b142*k2 + b143*k3 + b144*k4 + b145*k5 + b146*k6 + b147*k7 + b148*k8 + b149*k9 + b1410*k10 + b1411*k11 + b1412*k12 + b1413*k13));
        k15 = f(t + a15*h,             y + h*(b151*k1 + b152*k2 + b153*k3 + b154*k4 + b155*k5 + b156*k6 + b157*k7 + b158*k8 + b159*k9 + b1510*k10 + b1511*k11 + b1512*k12 + b1513*k13 + b1514*k14));
        k16 = f(t + a16*h, y + h*(b161*k1 + b162*k2 + b163*k3 + b164*k4 + b165*k5 + b166*k6 + b167*k7 + b168*k8 + b169*k9 + b1610*k10 + b1611*k11 + b1612*k12 + b1613*k13 + b1614*k14 + b1615*k15));

        % Update Values
        y = y + h * (c1*k1 + c3*k3 + c6*k6 + c7*k7 + c8*k8 + c9*k9 + c10*k10 + c11*k11 + c12*k12 + c13*k13 + c14*k14 + c15*k15 + c16*k16);
        t = t + h;

        % Store Values
        Idx       = Idx + 1;
        Time(Idx) = t;
        Y(Idx, :) = y';
    end
end
